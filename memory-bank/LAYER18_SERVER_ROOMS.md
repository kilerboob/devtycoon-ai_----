# LAYER 18 ‚Äî SERVER ROOMS (–†–µ–∞–ª–∏–∑–∞—Ü–∏—è)

## –î–∞—Ç–∞
3 –¥–µ–∫–∞–±—Ä—è 2025

## –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### 1. Backend Database Schema
- **server_rooms**: –¢–∞–±–ª–∏—Ü–∞ –∏–≥—Ä–æ–≤—ã—Ö –ª–æ–∫–∞—Ü–∏–π (–¥–∞—Ç–∞-—Ü–µ–Ω—Ç—Ä–æ–≤) —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –Ω–∞–≥—Ä–∞–¥–∞–º–∏, —Ç–∏–ø–∞–º–∏.
- **raids**: –ò–Ω—Å—Ç–∞–Ω—Å—ã –≤–∑–ª–æ–º–∞ —Å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å–∞, —Ç–∏–ø–æ–≤ (solo/group/pvp), —Ñ–∞–∑ (preparation/hacking/completed).
- **raid_participants**: –£—á–∞—Å—Ç–Ω–∏–∫–∏ —Ä–µ–π–¥–∞ —Å –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π (–ø–æ–ø—ã—Ç–∫–∏ –≤–∑–ª–æ–º–∞, —É—Ä–æ–Ω, –¥–æ–±—ã—á–∞).
- **raid_rewards**: –°–∏—Å—Ç–µ–º–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–∞–≥—Ä–∞–¥ (–∫—Ä–µ–¥–∏—Ç—ã, XP, —ç–∫–∏–ø–∏—Ä–æ–≤–∫–∞, —Ç–∏—Ç—É–ª—ã).
- –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ —Ç–∏–ø–∞–º, —Å—Ç–∞—Ç—É—Å–∞–º, –∏–≥—Ä–æ–∫–∞–º.

### 2. Backend REST API (serverRoomsRoutes.ts)
- `GET /server-rooms` ‚Äî –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ª–æ–∫–∞—Ü–∏–π —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –ø–æ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –∏ —Ç–∏–ø—É.
- `GET /server-rooms/:roomId` ‚Äî –î–µ—Ç–∞–ª–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞.
- `POST /raids` ‚Äî –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ä–µ–π–¥–∞ (–Ω–∞—á–∞–ª–æ –≤–∑–ª–æ–º–∞).
- `POST /raids/:raidId/join` ‚Äî –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∫ —Ä–µ–π–¥—É.
- `PATCH /raids/:raidId/progress` ‚Äî –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –≤–∑–ª–æ–º–∞ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —É—á–∞—Å—Ç–Ω–∏–∫–∞.
- `POST /raids/:raidId/complete` ‚Äî –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–µ–π–¥–∞ –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞–≥—Ä–∞–¥.
- `GET /raids/active` ‚Äî –°–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ä–µ–π–¥–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.
- `GET /raids/:raidId` ‚Äî –î–µ—Ç–∞–ª–∏ —Ä–µ–π–¥–∞ —Å —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏ –∏ –Ω–∞–≥—Ä–∞–¥–∞–º–∏.
- `GET /raids/rewards/:playerId` ‚Äî –ò—Å—Ç–æ—Ä–∏—è –Ω–∞–≥—Ä–∞–¥ –∏–≥—Ä–æ–∫–∞.

### 3. Frontend Component (ServerRoomsApp.tsx)
- **–°–ø–∏—Å–æ–∫ —Å–µ—Ä–≤–µ—Ä–æ–≤**: 5 –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –ª–æ–∫–∞—Ü–∏–π (Nexus Alpha ‚Üí Prime, Shadow Network) —Å —Ä–∞–∑–Ω—ã–º–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç—è–º–∏.
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**: –¢–∏–ø (PvE/PvP), —Å–ª–æ–∂–Ω–æ—Å—Ç—å (easy-legendary), —É—Ä–æ–≤–µ–Ω—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –º–æ—â—å AI-–∑–∞—â–∏—Ç—ã.
- **–ù–∞–≥—Ä–∞–¥—ã**: –ö—Ä–µ–¥–∏—Ç—ã, XP –ø–æ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏.
- **–í—ã–±–æ—Ä —Ç–∏–ø–∞ —Ä–µ–π–¥–∞**: Solo (1 –∏–≥—Ä–æ–∫) –∏–ª–∏ Group (–¥–æ 4 —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤).

### 4. Hacking Minigame
- **–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –º–∏–Ω–∏-–∏–≥—Ä–∞** —Å –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–æ–º (0-100%).
- **–ó–∞–¥–∞—á–∏**: –°–ª—É—á–∞–π–Ω—ã–µ –≤—ã–∑–æ–≤—ã (—Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞, –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞, –ø–æ—Ä—Ç—ã, —É—Ä–æ–≤–Ω–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏).
- **–ü–æ–ø—ã—Ç–∫–∏**: –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤; –ø—Ä–∏ 0 –ø–æ–ø—ã—Ç–∫–∞—Ö ‚Äî —Ä–µ–π–¥ –ø—Ä–æ–≤–∞–ª–µ–Ω.
- **–¢–∞–π–º–µ—Ä**: –í—Ä–µ–º—è –Ω–∞ –≤–∑–ª–æ–º –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ (30-70 —Å–µ–∫).
- **–ó–≤—É–∫–æ–≤—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã**: Success/Error –ø—Ä–∏ –æ—Ç–≤–µ—Ç–∞—Ö.
- **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞**: –°—á—ë—Ç—á–∏–∫ —É—Å–ø–µ—Ö–æ–≤, –æ—à–∏–±–æ–∫, –æ—Å—Ç–∞–≤—à–µ–≥–æ—Å—è –≤—Ä–µ–º–µ–Ω–∏.
- **–ù–∞–≥—Ä–∞–¥—ã**: –ú–Ω–æ–∂–∏—Ç–µ–ª—å –Ω–∞–≥—Ä–∞–¥—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ (√ó 1.5 –Ω–∞ hard, √ó 2.5 –Ω–∞ legendary).

### 5. Integration in Desktop
- –ù–æ–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ **Raids** –Ω–∞ —Ä–∞–±–æ—á–µ–º —Å—Ç–æ–ª–µ (–∏–∫–æ–Ω–∫–∞ üåê, –ø–æ–∑–∏—Ü–∏—è –º–µ–∂–¥—É Labs –∏ Planet).
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ `Desktop.tsx` —Å –ø–æ–ª–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏/–∑–∞–∫—Ä—ã—Ç–∏—è.

### 6. Memory Bank
- –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ä–µ–π–¥–æ–≤, –Ω–∞–≥—Ä–∞–¥, PvE/PvP —Å–∏—Å—Ç–µ–º –¥–ª—è –±—É–¥—É—â–∏—Ö —Å–µ—Å—Å–∏–π.

## –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∫–∏

### PvE (Solo/Group)
- –ò–≥—Ä–æ–∫(–∏) –≤—ã–±–∏—Ä–∞—é—Ç —Å–µ—Ä–≤–µ—Ä –∏ –Ω–∞—á–∏–Ω–∞—é—Ç —Ä–µ–π–¥.
- –ü—Ä–æ—Ö–æ–¥—è—Ç –º–∏–Ω–∏-–∏–≥—Ä—É –≤–∑–ª–æ–º–∞ —Å –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–º –≤—Ä–µ–º–µ–Ω–µ–º –∏ –ø–æ–ø—ã—Ç–∫–∞–º–∏.
- –ü—Ä–∏ —É—Å–ø–µ—Ö–µ –ø–æ–ª—É—á–∞—é—Ç –Ω–∞–≥—Ä–∞–¥—ã (–∫—Ä–µ–¥–∏—Ç—ã, XP) –ø–æ —Ñ–æ—Ä–º—É–ª–µ: `base_reward √ó (1 + difficulty_level √ó 0.5)`.
- –ù–µ–ª—å–∑—è –≤–∑–ª–æ–º–∞—Ç—å —Å –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º < 100% –∏–ª–∏ –ø–æ—Å–ª–µ –∏—Å—á–∏—Å–ª–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏.

### PvP (Group Raids)
- –ì—Ä—É–ø–ø—ã –∏–≥—Ä–æ–∫–æ–≤ —Å—Ä–∞–∂–∞—é—Ç—Å—è –∑–∞ —Ä–µ—Å—É—Ä—Å—ã –æ–¥–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞.
- –õ–∏–¥–µ—Ä —Å–æ–∑–¥–∞—ë—Ç —Ä–µ–π–¥, –¥—Ä—É–≥–∏–µ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω—è—é—Ç—Å—è.
- –ù–∞–≥—Ä–∞–¥—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –ø–æ—Ä–æ–≤–Ω—É –º–µ–∂–¥—É —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏.
- –†–µ–π–¥ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è, –∫–æ–≥–¥–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å –¥–æ—Å—Ç–∏–≥–∞–µ—Ç 100% –∏–ª–∏ –∏—Å—Ç–µ–∫–∞–µ—Ç –≤—Ä–µ–º—è.

### Difficulty Scaling
- **Easy**: 1x –Ω–∞–≥—Ä–∞–¥–∞, 30 —Å–µ–∫, –±–∞–∑–æ–≤–∞—è –∑–∞—â–∏—Ç–∞ (30%).
- **Normal**: 1.5x –Ω–∞–≥—Ä–∞–¥–∞, 40 —Å–µ–∫, —Å—Ä–µ–¥–Ω—è—è –∑–∞—â–∏—Ç–∞ (60%).
- **Hard**: 2x –Ω–∞–≥—Ä–∞–¥–∞, 50 —Å–µ–∫, –≤—ã—Å–æ–∫–∞—è –∑–∞—â–∏—Ç–∞ (90%).
- **Legendary**: 2.5x –Ω–∞–≥—Ä–∞–¥–∞, 70 —Å–µ–∫, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞ (150%).

### Reward Distribution
```
Per player = total_reward / participant_count
Loot drops: Common, Uncommon, Rare, Epic, Legendary
```

## –ß—Ç–æ –¥–∞–ª—å—à–µ

1. **3D –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞—Ç–∞-—Ü–µ–Ω—Ç—Ä–æ–≤** (Three.js) —Å –º–æ–¥–µ–ª—è–º–∏ —Å–µ—Ä–≤–µ—Ä–æ–≤, —Å—Ç–∞—Ç—É—Å-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã.
2. **Leaderboard** –ø–æ –∫–æ–ª-–≤—É —É—Å–ø–µ—à–Ω—ã—Ö —Ä–µ–π–¥–æ–≤, –¥–æ–±—ã—Ç—ã–º —Ä–µ—Å—É—Ä—Å–∞–º, –≤—Ä–µ–º–µ–Ω–∏ –≤–∑–ª–æ–º–∞.
3. **–°–µ–∑–æ–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è**: –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ –≤—Ä–µ–º–µ–Ω–∏, —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –Ω–∞–≥—Ä–∞–¥—ã.
4. **Multiplayer —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è** —á–µ—Ä–µ–∑ WebSocket –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏.
5. **–ó–∞—â–∏—Ç–∞ –æ—Ç —Ä–µ–π–¥–æ–≤**: –ò–≥—Ä–æ–∫–∏ –º–æ–≥—É—Ç —É–∫—Ä–µ–ø–ª—è—Ç—å —Å–≤–æ–∏ —Å–µ—Ä–≤–µ—Ä—ã, –ø–æ–ª—É—á–∞—Ç—å –Ω–∞–≥—Ä–∞–¥—ã –∑–∞ —É—Å–ø–µ—à–Ω—É—é –∑–∞—â–∏—Ç—É.
6. **–õ–æ–∫–∞–ª—å–Ω–∞—è —ç–∫–æ–Ω–æ–º–∏–∫–∞**: –ü—Ä–æ–¥–∞–∂–∞ –≤–∑–ª–æ–º–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –Ω–∞ Shadow Market.

## –§–∞–π–ª—ã

- `/backend/sql/server_rooms_layer.sql` ‚Äî DB schema –∏ –∏–Ω–∏—Ü–∏–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.
- `/backend/src/routes/serverRoomsRoutes.ts` ‚Äî REST API.
- `/components/ServerRoomsApp.tsx` ‚Äî Frontend UI + –º–∏–Ω–∏-–∏–≥—Ä–∞.
- `/backend/src/server.ts` ‚Äî –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –º–∞—Ä—à—Ä—É—Ç–æ–≤.
- `/components/Desktop.tsx` ‚Äî –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ —Ä–∞–±–æ—á–∏–π —Å—Ç–æ–ª.

## –°—Ç–∞—Ç—É—Å
‚úÖ **Alpha** ‚Äî –û—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –≥–æ—Ç–æ–≤, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ.
